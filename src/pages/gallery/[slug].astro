---
import { getCollection, getEntry } from "astro:content"
import Layout from "../../layouts/Layout.astro"

const { slug } = Astro.params
if (!slug) throw new Error("Slug not found")
console.log(slug)
const post = await getEntry("artwork", slug)
console.log(post)

if (!post) throw new Error("No post found for this slug")
const { Content } = await post.render()

// Generate static pages
export async function getStaticPaths() {
  const artwork = await getCollection("artwork")
  return artwork.map((post) => ({ params: { slug: post.slug } }))
}
---

<Layout title={post.data.title}>
  <h1>{post.data.title}</h1>
  <img src={`../${post.data.image}`} alt={post.data.title} />
  <Content />
  <pre>{JSON.stringify(post,null,2)}</pre>
</Layout>
